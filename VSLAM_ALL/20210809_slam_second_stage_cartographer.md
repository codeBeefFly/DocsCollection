# 2021年08月11日：安装运行 ros slam cartographer

[toc]

---

记录 cartographer 的安装与运行



---

## 1. installation

### 1.1. 安装 protobuf3

```
sudo apt-get install autoconf autogen

git clone https://github.com/protocolbuffers/protobuf.git

cd protobuf

git submodule update --init --recursive

./autogen.sh
./configure

make

make check  # 这一步可能会报错，无视就好
sudo make install

sudo ldconfig  # refresh shared library cache.
————————————————
版权声明：本文为CSDN博主「北方诸哲」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。
原文链接：https://blog.csdn.net/seeseeatre/article/details/84863485
```

```
ds16v2@ds16v2:~/MakeDepends/dep_ds/protobuf$ protoc --version
libprotoc 3.17.3
```

![image-20210811193908562](20210809_slam_second_stage_cartographer.assets/image-20210811193908562.png)



### 2.2. 安装 wstool, rosdep, ninja 工具：

```
sudo apt-get update

# old ros distribution, kinetic
sudo apt-get install -y python-wstool python-rosdep ninja-build stow
```

```
ds16v2@ds16v2:~/MakeDepends/dep_ds/protobuf$ sudo apt-get install python-wstool python-rosdep ninja-build
Reading package lists... Done
Building dependency tree       
Reading state information... Done
ninja-build is already the newest version (1.5.1-0.1ubuntu1).
python-rosdep is already the newest version (0.21.0-1).
python-wstool is already the newest version (0.1.17-1).
The following package was automatically installed and is no longer required:
  python3-wheel
Use 'sudo apt autoremove' to remove it.
0 upgraded, 0 newly installed, 0 to remove and 2 not upgraded.
```

![image-20210811194427733](20210809_slam_second_stage_cartographer.assets/image-20210811194427733.png)



### 2.3. 安装 cartographer_ros 的依赖：

**创建 cartographer_ws：**

```
mkdir cartographer_ws
cd cartographer_ws
wstool init src  # 创建 ros warkspace 的 src 包
```

**关联远程仓库，从远程仓库拷贝 cartographer，cartographer_ros，ceres-solver 源代码并更新：**

```
wstool merge -t src https://raw.githubusercontent.com/googlecartographer/cartographer_ros/master/cartographer_ros.rosinstall

wstool update -t src
```

```
.
└── src
    ├── cartographer
    ├── cartographer_ros
    ├── ceres-solver
    └── .rosinstall
```

<img src="20210809_slam_second_stage_cartographer.assets/image-20210811201832924.png" alt="image-20210811201832924" style="zoom:100%;float:left" />

查看 `.rosinstall` 隐藏文件，文件内容是 cartographer 源代码远程仓库地址：

```
gedit .../cartographer_ws/src/.rosinstall
```

```json
# THIS IS AN AUTOGENERATED FILE, LAST GENERATED USING wstool ON 2021-08-10
- git: {local-name: cartographer, uri: 'https://github.com/cartographer-project/cartographer.git', version: 'master'}
- git: {local-name: cartographer_ros, uri: 'https://github.com/cartographer-project/cartographer_ros.git', version: 'master'}
- git: {local-name: ceres-solver, uri: 'https://github.com/ceres-solver/ceres-solver.git', version: 'master'}
```
更新源代码：
```
ds16v2@ds16v2:~/catkin_x/cartographer_ws$ wstool update -t src

[cartographer] Updating /home/ds16v2/catkin_x/cartographer_ws/src/cartographer
[cartographer] Done.
[cartographer_ros] Updating /home/ds16v2/catkin_x/cartographer_ws/src/cartographer_ros
[cartographer_ros] Done.
[ceres-solver] Updating /home/ds16v2/catkin_x/cartographer_ws/src/ceres-solver
[ceres-solver] Done.
```







### &. 参考：

1. [Cartographer<谷歌官网cartographer>](https://google-cartographer.readthedocs.io/en/latest/)
2. [Compiling Cartographer ROS](https://google-cartographer-ros.readthedocs.io/en/latest/compilation.html)
3. [Cartographer的原理与应用<又是cxx哥们的博客>](https://cxx0822.github.io/2019/11/11/cartographer-de-yuan-li-yu-ying-yong/)





---

## 2. implementation





---

## 3. issues collection

### 1. issue: sudo rosdep init

```
ds16v2@ds16v2:~$ sudo rosdep init
[sudo] password for ds16v2: 
ERROR: cannot download default sources list from:
https://raw.githubusercontent.com/ros/rosdistro/master/rosdep/sources.list.d/20-default.list
Website may be down.
```

![image-20210811171618068](20210809_slam_second_stage_cartographer.assets/image-20210811171618068.png)





### 2. issue: rosdep update 

```
ds16v2@ds16v2:~$ rosdep update
reading in sources list data from /etc/ros/rosdep/sources.list.d
ERROR: unable to process source [https://raw.githubusercontent.com/ros/rosdistro/master/rosdep/osx-homebrew.yaml]:
	<urlopen error EOF occurred in violation of protocol (_ssl.c:590)> (https://raw.githubusercontent.com/ros/rosdistro/master/rosdep/osx-homebrew.yaml)
ERROR: unable to process source [https://raw.githubusercontent.com/ros/rosdistro/master/rosdep/base.yaml]:
	<urlopen error [Errno 110] Connection timed out> (https://raw.githubusercontent.com/ros/rosdistro/master/rosdep/base.yaml)
Hit https://raw.githubusercontent.com/ros/rosdistro/master/rosdep/python.yaml
Hit https://raw.githubusercontent.com/ros/rosdistro/master/rosdep/ruby.yaml
Hit https://raw.githubusercontent.com/ros/rosdistro/master/releases/fuerte.yaml
Query rosdistro index https://raw.githubusercontent.com/ros/rosdistro/master/index-v4.yaml
Skip end-of-life distro "ardent"
Skip end-of-life distro "bouncy"
Skip end-of-life distro "crystal"
Skip end-of-life distro "dashing"
Skip end-of-life distro "eloquent"
Add distro "foxy"
Add distro "galactic"
Skip end-of-life distro "groovy"
Skip end-of-life distro "hydro"
Skip end-of-life distro "indigo"
Skip end-of-life distro "jade"
Skip end-of-life distro "kinetic"
Skip end-of-life distro "lunar"
Add distro "melodic"
Add distro "noetic"
Add distro "rolling"
ERROR: error loading sources list:
	<urlopen error <urlopen error ('_ssl.c:574: The handshake operation timed out',)> (https://raw.githubusercontent.com/ros/rosdistro/master/rolling/distribution.yaml)>
```

![image-20210811170504437](20210809_slam_second_stage_cartographer.assets/image-20210811170504437.png)





#### &. 参考：

1. [ROS:sudo rosdep init出错常规方法都无效后解决办法记录](https://zhuanlan.zhihu.com/p/77483614)
2. 





---

## &. reference

